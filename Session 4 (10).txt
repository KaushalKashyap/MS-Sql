USE TEST;

SELECT * FROM EMP 
WHERE CITY = 'DELHI';

CREATE INDEX L28I1 ON EMP (CITY);

DROP INDEX L28I1 ON EMP;

SELECT * FROM EMP
WHERE ADDRESS2 = 'DWARKA';

SELECT * FROM EMP
WHERE CITY = 'DELHI' AND ADDRESS2 = 'DWARKA';

-- COMPOSIT INDEX 

CREATE INDEX L28I2 ON EMP (CITY, ADDRESS2);

-- IMPLICIT -AUTOMIATIC - PRIMARY KEY / UNIQUE
-- EXPLICIT - WE CREATE

-- NON CLUSTERED INDEX
-- CLUSTERED INDEX

CREATE CLUSTERED INDEX L28I3 ON EMP (ADDRESS2);

DROP VIEW L28VEMP;

CREATE VIEW L28VEMP
AS 
	SELECT * FROM EMP 
	WHERE CITY = 'DEHRADUN';


CREATE VIEW L28VEMP
AS 
	SELECT * FROM EMP 
	WHERE CITY = 'DEHRADUN'
	WITH CHECK OPTION;



SELECT * FROM L28VEMP;

INSERT INTO EMP
VALUES(1192, 'GURJEET SINGH', 'MOHINI ROAD' , 'DALANWALA', 'DEHRADUN', '9111876509', 'SINGHG@YAHOO.COM', '13-DEC-1991', '20-NOV-2020');

DELETE FROM EMP WHERE EID = 1192;


INSERT INTO L28VEMP
VALUES(1192, 'GURJEET SINGH', 'MOHINI ROAD' , 'DALANWALA', 'DEHRADUN', '9111876509', 'SINGHG@YAHOO.COM', '13-DEC-1991', '20-NOV-2020');

DELETE FROM L28VEMP WHERE EID = 1192;


DELETE FROM EMP WHERE EID = 1192;

INSERT INTO L28VEMP
VALUES(1192, 'GURJEET SINGH', 'HNO 120' , 'RAJOURI GARDEN', 'DELHI', '9111876509', 'SINGHG@YAHOO.COM', '13-DEC-1991', '20-NOV-2020');


CREATE VIEW L28V2EMP
AS	
	SELECT EID, NAME, CITY, PHONENO, EMAIL, DOJ 
	FROM EMP;

SELECT * FROM L28V2EMP;

CREATE VIEW L28VSAL
AS
	
	SELECT EMP.EID, NAME, CITY, DOJ, DEPT, DESI, SALARY AS'BASIC', SALARY * .15 AS'HRA', SALARY *.09 AS 'PF'
	FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID = EMP_SAL.EID;

SELECT * FROM L28VSAL;
	
	SELECT DISTINCT DEPT FROM EMP_SAL;

	SELECT SUM(SALARY) FROM EMP_SAL;

	SELECT DEPT, SUM(SALARY)
	FROM EMP_SAL
	GROUP BY DEPT;

CREATE VIEW L28V4
AS
	SELECT * FROM EMP_SAL
	WHERE DEPT = 'HR';

SELECT * FROM L28V4
	ORDER BY SALARY DESC;